

#  README

## 1. 项目简介结构动力响应计算器（SDOF）

本程序为 **单自由度线性结构动力响应分析工具**，基于 Python + Tkinter 图形界面，实现多种经典解析与数值积分方法的并行计算与对比，可用于：

- 教学演示不同时间积分算法的特性
- 数值稳定性、精度与步长敏感性分析
- 外荷载函数形式对响应的影响研究

系统求解对象为：

$m\ddot{u}(t)+c\dot{u}(t)+ku(t)=F(t)$

其中阻尼采用等效粘滞阻尼，支持任意时间函数形式的外荷载。

------

## 2. 支持的计算方法

程序同时计算并可视化以下方法的时程响应（位移、速度、加速度）：

1. **杜哈梅积分（Duhamel Integral）**
   - 基于连续卷积积分
   - 数值积分采用 Simpson / 梯形法
   - 作为高精度参考解
2. **一般解法（分段恒载解析解）**
   - 假定步内荷载恒定
   - 闭式解析递推
   - 本质为解析时间步进法
3. **激励插值法（Force Interpolation Method）**
   - 假定步内荷载线性变化
   - 欠阻尼条件下闭式递推
   - 精度高、数值耗散小
4. **中心差分法（Central Difference）**
   - 显式格式
   - 条件稳定
   - 自动给出稳定性步长提示
5. **Newmark-β 方法**
   - 线性加速度法（β=1/6, γ=1/2）
   - 平均加速度法（β=1/4, γ=1/2，无条件稳定）
6. **Wilson-θ 方法**
   - 默认 θ=1.42
   - 隐式格式
   - 对高频有数值耗散

------

## 3. 运行环境与依赖

### Python 版本

- Python ≥ 3.8

### 依赖库

```bash
numpy
scipy
matplotlib
tkinter
```

如未安装 SciPy / Matplotlib：

```bash
pip install numpy scipy matplotlib
```

------

## 4. 启动方式

直接运行主脚本：

```bash
python main.py
```

启动后将弹出图形界面。

------

## 5. 图形界面说明

### 5.1 参数输入区

#### （1）结构参数

- **质量 m (kg)**
- **刚度 k (N/m)**
- **阻尼比 ζ**

阻尼模型：
$c = 2m\omega_0\zeta,\quad \omega_0=\sqrt{k/m}$

#### （2）初始条件

- 初始位移 (u_0)
- 初始速度 (v_0)

初始加速度由平衡方程反算。

#### （3）时间与离散

- **总步数 N**
- **总时长 T (s)**

时间步长：
$
\Delta t = T/N
$

#### （4）外荷载 F(t)

支持 Python 表达式形式，变量为 `t`，允许函数包括：

- `sin, cos, tan`
- `exp, sqrt, abs`
- `pi`
- `np`（NumPy）

示例(Dynamics of Structures)：

```text
44482 * sin(pi*t/0.6)
1000 * exp(-2*t)
500
```

------

### 5.2 显示控制区a

- 每种方法对应一个复选框
- 可动态显示/隐藏曲线
- 不会重复计算，仅刷新绘图

------

## 6. 输出结果说明

### 6.1 绘图内容

右侧绘图区包含三行子图：

1. 位移 (u(t))
2. 速度 (v(t))
3. 加速度 (a(t))

所有方法共用同一时间轴，颜色与线型区分。

### 6.2 数值稳定性提示

程序自动计算：

- 自振周期
  $T_n = \frac{2\pi}{\omega_0}$
- 中心差分法经验稳定步长
  $\Delta t_{cr} \approx \frac{T_n}{\pi}$

若：

```text
dt > Δt_cr
```

界面左下角将显示 **不稳定警告**。

------

## 7. 数值实现说明

- 所有方法均在 **同一时间离散** 下计算，便于直接对比
- 发散判据：
  - 位移绝对值 > 1e15
  - 或出现 NaN
    → 后续结果置 NaN 并终止该方法计算
- 杜哈梅法内部采用 **更细时间步**，最终插值回主时间轴

------

## 8. 适用范围与限制

- 系统类型：
  **线性单自由度系统**
- 阻尼类型：
  **粘滞阻尼**
- 激励插值法仅适用于：
  $\zeta < 1 \quad \text{（欠阻尼）}$
------

## 9. 典型用途建议

- 对比显式 / 隐式算法稳定性
- 验证 Newmark 参数对数值耗散的影响
- 以杜哈梅积分作为“参考解”评估误差
- 教学演示时间积分方法差异

------

## 10. 备注

- 本程序偏向 **算法对比与教学研究**，未针对大规模或高性能优化
- 若用于工程计算，请自行评估步长、稳定性与误差要求

------

如需：

- 增加非线性（弹塑性、摩擦）
- 多自由度系统（MDOF）
- 地震动输入（加速度激励）

可在当前框架上进一步扩展。
